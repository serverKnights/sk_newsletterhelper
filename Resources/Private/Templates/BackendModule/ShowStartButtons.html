<html
        xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
        xmlns:core="http://typo3.org/ns/TYPO3/CMS/Core/ViewHelpers"
        xmlns:be="http://typo3.org/ns/TYPO3/CMS/Backend/ViewHelpers"
        data-namespace-typo3-fluid="true">

<f:layout name="ModuleLayout" />

<f:section name="Content">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var form = document.getElementById('mjmlInstallForm');
            var loadingIcon = document.getElementById('loadingOverlay');

            form.addEventListener('submit', function() {
                // Show loading icon
                loadingIcon.style.display = 'flex';
            });
        });
    </script>

    <style>
        #loadingOverlay {
            position: fixed; /* Use fixed positioning */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(128, 128, 128, 0.5);
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            z-index: 9999;
            flex-direction: column;
        }

        #loadingIcon {
            width: 50px;
            height: auto;
        }
    </style>

    <div id="loadingOverlay" style="display:none;">
        <f:image src="EXT:sk_newsletterhelper/Resources/Public/Icons/Fidget-spinner.gif" alt="Loading..." id="loadingIcon" />
        <p>please wait for mjml to install ...</p>
    </div>

    <h1>Newsletter Helper</h1>
    <h3>Settings not complete</h3>
    <p>Please set the required settings using then Buttons below or enter the paths to the node_modules containing mjml and the Node executable</p>


    <div class="sk-start-button-wrapper" style="display: flex; gap: 10px;">
        <f:if condition="{0:isNodePresent} == {0: NULL}">
            <f:then>
                <f:form method="POST">
                    <f:form.textfield name="checkAndSetNode" value="true" type="hidden"></f:form.textfield>
                    <f:form.textfield type="submit" value="Scan and set Node path"></f:form.textfield>
                </f:form>
            </f:then>
        </f:if>
        <f:if condition="{isNodePresent}">
            <f:then>
                <p style="color: green">Node path set to {nodePath}</p>
            </f:then>
        </f:if>
        <f:if condition="{isNodePresent} === false ">
            <f:then>
                <p style="color: red">Please install Node on your system and reload the settings page</p>
            </f:then>
        </f:if>



        <f:if condition="{0:isMjmlPresent} == {0: NULL}">
            <f:then>
                <f:form method="POST">
                    <f:form.textfield name="checkAndSetMjml" value="true" type="hidden"></f:form.textfield>
                    <f:form.textfield type="submit" value="Scan and set MJML path"></f:form.textfield>
                </f:form>
            </f:then>
        </f:if>
        <f:if condition="{isMjmlPresent}">
            <f:then>
                <p style="color: green">MJml path set to {mjmlPath}</p>
            </f:then>
        </f:if>
        <f:if condition="{isMjmlPresent} === false ">
            <f:then>
                <p style="color: red">Please install mjml on your system or use the installation button</p>
                <f:form method="POST" id="mjmlInstallForm">
                    <f:form.textfield name="installMJML" value="true" type="hidden"></f:form.textfield>
                    <f:form.textfield type="submit" value="Install MJML"></f:form.textfield>
                </f:form>
            </f:then>
        </f:if>

    </div>



</f:section>



</html>